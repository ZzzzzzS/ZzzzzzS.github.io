language: node_js  #设置语言

node_js: '6.11.1'  #设置相应的版本

cache:
    apt: true
    directories:
        - node_modules # 缓存不经常更改的内容

before_install:
    - export TZ='Asia/Shanghai' # 更改时区

install:
  - npm install  hexo-cli -g #安装hexo及插件
  - npm install hexo-deployer-git --save
  - npm install hexo-generator-sitemap --save
  - npm install node-sass --save
  - npm install --save hexo-autoprefixer hexo-filter-cleanup hexo-generator-feed hexo-generator-sitemap hexo-renderer-sass hexo-renderer-swig mamboer/lunr.js moment object-assign 
script:
  - hexo clean  #清除
  - hexo g   #生成

after_script:
    - git clone https://${GH_REF} .deploy_git  # GH_REF是最下面配置的仓库地址
    - cd .deploy_git
    - git checkout master
    - cd ../
    - mv .deploy_git/.git/ ./public/   # 这一步之前的操作是为了保留master分支的提交记录，不然每次git init的话只有1条commit
    - cd ./public
    - git config user.name "Travis"  #修改name
    - git config user.email "m18996002212@me.com"  #修改email
    - git add .
    - git commit -m "Travis CI Auto Builder at `date +"%Y-%m-%d %H:%M"`"  # 提交记录包含时间 跟上面更改时区配合
    - git push --force --quiet "https://${Travis_Token}@${GH_REF}" master:master  #Travis_Token是在Travis中配置环境变量的名称

branches:
  only:
    - source  #只监测master分支，master是我的分支的名称，可根据自己情况设置
env:
 global:
   - GH_REF: github.com/ZzzzzzS/ZzzzzzS.github.io.git  #设置GH_REF，注意更改yourname
   - secure: F3Up+WGABPFwJ0t+3715GCu7QZ7b4IZmERttm9z94RvO4q41GongTlnUkrmBlz5p78KatpzREbe4YNhfzjRn25l1ptqTUniaxpvC4rfwL0RLqBjvXcIEVFOAknVu2xJXHfCIuBQjMq3WNslSWO1V77MaM8+j3mVKBq4pQNlGwCxd+zuckRVSqoGtNGom8Ep65jhw2TGkq4/dowjFbrxSg3pCbnS72fZvVdSd167w3KKUXxp+B/xnjNAUgKU0n/ash46nkRPCDXfTE3mA3NK+CKZyRKVQt8q1Y2ykBiq5Szk/tzA6K9T3Uy+gwwVdhODBkeuS2uTRrN1f3wx+aqL0uLzKbczA+QPTphEyp0HTC81dUaKymIiw+QbdlqxOZ5B9bOJcJpnP6rvUXUdfYZ9CJ01FQhXJfR+w0ZMf6dRqkHIpmcvUiACS1kopLoJi5KvLEpn/lK6X7tbWHsWldchN3E4ep6JOFTZHjpnjU1ouVxuqyNtK6KTAUYf7TPpno5hp5dxiVNjbWJKSHwop816838q4rwvJo63glWFHdhmOOuY1OAzexCTGrQxhWaj/y99w92S6JS6WiP3uzfDGWi+7ctzazlF1C/xgwE/n83i/TjRqabPnwkZhm1MqWvVWOks95jAsDSryd+WTRNAoafyA4SfVJRufIBAVMFfzaRvvaYE=

# configure notifications (email, IRC, campfire etc)
# please update this section to your needs!
# https://docs.travis-ci.com/user/notifications/
notifications:
  email:
    - m18996002212@me.com
  on_success: always
  on_failure: always